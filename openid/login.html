<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Haventec Authenticate sample server</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">

    <style type="text/css">
        body{font-family:Roboto-Regular,Arial,sans-serif;}h1{font-size:2.5rem;margin:1rem 0 3rem;}img{margin:4rem 0 2rem}.container{display:flex;justify-content:center;align-items:center;flex-direction:column;}input{display:block;height:1.5rem;width:200px;margin:1rem 0;font-size:1rem;padding:5px}button{background:#0096D7;color:#fff;cursor:pointer;display:inline-block;font-weight:400;line-height:1.25;text-align:center;white-space:nowrap;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid transparent;padding:.5rem 1rem;font-size:1rem;border-radius:.25rem;width:212px}form{text-align:center}
    </style>

</head>
<body>

    <div class="container">
        <img src="data:image/png;base64,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">
        <h1 class="item">Haventec Authenticate Sample Server - OpenID Login</h1>

        <a href="#" onclick="gotoAddDevice();">Add Device</a>
        
        <form id="ht-form" action="#">
          <input id="ht-username" type="text" placeholder="username" required/>
          <input id="ht-pin" type="text" placeholder="Pin code" required/>
            <button id="ht-submit">Login</button>
        </form>
    </div>

    <script src="sjcl.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

    <script>

        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        };

    function getBase64Hash512SaltedPin(pin, salt) {
        let hash512 = new sjcl.hash.sha512();
        hash512.update(salt);
        hash512.update(pin);
        let hashed = hash512.finalize();
        return sjcl.codec.base64.fromBits(hashed);
    }
    function generateSalt() {
        return sjcl.random.randomWords(128);
    }

    function getHashedPin(username, pin) {
      var salt = undefined;
      var saltStr = localStorage.getItem('ht_' + username + "salt");
      if ( !saltStr ) {
        salt = generateSalt();
        localStorage.setItem('ht_' + username + "salt", JSON.stringify(salt));
      } else {
        salt = JSON.parse(saltStr);
      }

      return getBase64Hash512SaltedPin(pin, salt);
    }

    function gotoAddDevice() {
        var applicationUuid = getUrlParameter("applicationUuid");
        var state = getUrlParameter("state");
        var redirect_uri = getUrlParameter("redirect_uri");
        window.open("addDevice.html?applicationUuid=" + applicationUuid + "&state=" + state + "&redirect_uri=" + redirect_uri, "_self");
    }

      $("document").ready(function(){
        $("#ht-submit").click(function(){

            var applicationUuid = getUrlParameter("applicationUuid");
            var state = getUrlParameter("state");
            var redirect_uri = getUrlParameter("redirect_uri");
            var username = $("#ht-username").val();
            var pin = $("#ht-pin").val();
            var deviceUuid = localStorage.getItem("ht_" + username + "_deviceUuid");
            var authKey = localStorage.getItem("ht_" + username + "_authKey");

//            String username;
//            String applicationUuid;
//            String deviceUuid;
//            String authKey;
//            String hashedPin;


          $.post( "/openid/login", {
                                applicationUuid: applicationUuid,
                                username: username,
                                deviceUuid: deviceUuid,
                                authKey: authKey,
                                hashedPin: getHashedPin(username, pin)
                              },
            function(data){
                alert("Login result = " + JSON.stringify(data));
              localStorage.setItem('ht_' + username + '_authKey', data.authKey);
//              window.open("http://localhost/authenticate/v1-2/openid/authcomplete?code="
//                  + data.accessToken.token + "&state=" + state + '&redirect_uri=' + redirect_uri, "_self");

                var thisCode = data.openidParameters.code;
                window.open(redirect_uri + '?code=' + thisCode + "&state=" + state, "_self");

            }).fail(function(err){
              alert("Login Error: " + JSON.stringify(err));
            });

            return false;
          });
        });
    </script>
</body>
</html>
